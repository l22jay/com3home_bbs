<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시글 작성</title>
</head>
<body>
    <h1>게시글 작성</h1>
    <form id="postForm">
        <label for="title">제목:</label>
        <input type="text" id="title" name="title" required><br><br>

        <label for="content">내용:</label><br>
        <textarea id="content" name="content" required></textarea><br><br>

        <button type="submit">등록</button>
    </form>

    <script>
        document.getElementById('postForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;

            // GitHub API를 통해 게시글을 리포지토리에 추가하기
            const postData = {
                message: `게시글 추가: ${title}`,
                content: btoa(`# ${title}\n\n${content}`)  // base64 인코딩
            };

            fetch("https://api.github.com/repos/l22jay/com3home_bbs/contents/posts/new-post.md", {
                method: "PUT",
                headers: {
                    "Authorization": `token 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`,  // GitHub Personal Access Token
                    "Accept": "application/vnd.github.v3+json",
                },
                body: JSON.stringify({
                    message: postData.message,
                    content: postData.content,
                })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                alert("게시글이 성공적으로 저장되었습니다!");
                document.getElementById('title').value = '';
                document.getElementById('content').value = '';
            })
            .catch(error => {
                console.error("Error:", error);
                alert("게시글 저장에 실패했습니다.");
            });
        });
    </script>
</body>
</html>
