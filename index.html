<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase 데이터 가져오기</title>
</head>
<body>

    <h1>Supabase API 3 데이터</h1>
    <button onclick="fetchData()">데이터 가져오기</button>
    <ul id="data-list"></ul>

    <!-- Supabase 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

    <script>
        // Supabase 클라이언트 초기화 (여기에 본인의 Supabase URL과 키를 입력)
        const supabaseUrl = 'https://aypexxxatdakzzlgnbng.supabase.co'; // 실제 URL로 변경
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF5cGV4eHhhdGRha3p6bGduYm5nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4MTI3NTEsImV4cCI6MjA1ODM4ODc1MX0.0wEZm3sOESn_5W_6wjCQA1UuQT66pRUpLpJJIl5dHps'; // 본인의 공개 API 키로 변경
        
        // supabase 객체가 정상적으로 초기화된 후, fetchData 함수가 호출되어야 함
        let supabase;

        // 페이지가 로드될 때 supabase 초기화
        window.onload = function() {
            supabase = supabase.createClient(supabaseUrl, supabaseKey);
        }

        // API 데이터 가져오기
        async function fetchData() {
            try {
                // supabase가 초기화된 후 데이터 가져오기
                if (!supabase) {
                    throw new Error('Supabase가 초기화되지 않았습니다.');
                }

                // Supabase에서 데이터 가져오기
                const { data, error } = await supabase
                    .from('posts')  // 실제 테이블 이름으로 변경
                    .select('id, title, content'); // 가져올 필드 지정

                if (error) {
                    throw new Error(error.message);
                }

                // HTML 리스트에 데이터 표시
                const dataList = document.getElementById('data-list');
                dataList.innerHTML = ''; // 기존 내용 초기화

                if (data && data.length > 0) {
                    data.forEach(item => {
                        const li = document.createElement('li');
                        li.innerHTML = `<strong>ID:</strong> ${item.id} <br> <strong>Title:</strong> ${item.title} <br> <strong>Content:</strong> ${item.content}`;
                        dataList.appendChild(li);
                    });
                } else {
                    dataList.innerHTML = '<li>데이터가 없습니다.</li>';
                }

            } catch (error) {
                console.error('데이터 가져오기 오류:', error);
            }
        }
    </script>

</body>
</html>
